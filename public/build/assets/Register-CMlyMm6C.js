import{d as T,a0 as B,d1 as F,r as _,x as z,G as D,H as G,X as I,y as K,z as R,c as i,b as n,u as e,a as o,J as j,F as m,f as u,E as c,w as U,n as h,e as f,ag as q,o as l,d2 as O,d3 as H,h as g,t as y,a3 as J,K as k}from"./main-Du4G26R4.js";import{_ as X}from"./FormSelect.vue_vue_type_script_setup_true_lang-FVJm_68N.js";import{_ as Y}from"./Button.vue_vue_type_script_setup_true_lang-DQBSEcl-.js";import{u as Q,r as p,e as W,m as b,a as P,i as Z,d as ee,s as te}from"./index-uhoSliyy.js";import{P as re}from"./vue-simple-password-meter.umd-CxFXjKhL.js";import{G as oe}from"./GoogleReCaptchaV3-DHqvWAFy.js";import"./vue.runtime.esm-bundler-Cezd3BPl.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const se={class:h(["p-3 sm:px-8 relative h-screen lg:overflow-hidden bg-primary xl:bg-white dark:bg-darkmode-800 xl:dark:bg-darkmode-600","before:hidden before:xl:block before:content-[''] before:w-[57%] before:-mt-[28%] before:-mb-[16%] before:-ml-[13%] before:absolute before:inset-y-0 before:left-0 before:transform before:rotate-[-4.5deg] before:bg-primary/20 before:rounded-[100%] before:dark:bg-darkmode-400","after:hidden after:xl:block after:content-[''] after:w-[57%] after:-mt-[20%] after:-mb-[13%] after:-ml-[13%] after:absolute after:inset-y-0 after:left-0 after:transform after:rotate-[-4.5deg] after:bg-primary after:rounded-[100%] after:dark:bg-darkmode-700"])},ae={class:"container relative z-10 sm:px-10"},ie={class:"block grid-cols-2 gap-4 xl:grid"},le={class:"flex-col hidden min-h-screen xl:flex"},de=o("a",{href:"",class:"flex items-center pt-5 -intro-x"},[o("span",{class:"ml-3 text-lg text-white"})],-1),ne={class:"my-auto"},me=["src"],ue=o("div",{class:"mt-10 text-4xl font-medium leading-tight text-white -intro-x"},[f(" Amtgard"),o("br"),f(" Online Record Keeper v4 ")],-1),ce=o("div",{class:"mt-5 text-lg text-white -intro-x text-opacity-70 dark:text-slate-400"}," Live the Dream! ",-1),pe={class:"flex h-screen py-5 my-10 xl:h-auto xl:py-0 xl:my-0"},fe={class:"w-full px-5 py-8 mx-auto my-auto bg-white rounded-md shadow-md xl:ml-20 dark:bg-darkmode-600 xl:bg-transparent sm:px-8 xl:p-0 xl:shadow-none sm:w-3/4 lg:w-2/4 xl:w-auto"},xe=o("h2",{class:"text-2xl font-bold text-center intro-x xl:text-3xl xl:text-left"}," Register ",-1),_e={class:"mt-8 intro-x"},ge=o("option",{value:"0",disabled:"",selected:""},"Pronouns",-1),he=["value"],ve={class:"flex items-center mt-4 text-xs intro-x text-slate-600 dark:text-slate-500 sm:text-sm"},ye=o("label",{class:"cursor-pointer select-none",htmlFor:"remember-me"}," I agree to the ",-1),ke=o("a",{class:"ml-1 text-primary dark:text-slate-200",href:"/legal",target:"_blank"}," Privacy Policy & Terms of Use ",-1),be={class:"flex items-center mt-4 text-xs intro-x text-slate-600 dark:text-slate-500 sm:text-sm"},we={style:{display:"inline"}},$e=o("div",{class:"mt-10 text-center intro-x xl:mt-24 text-slate-600 dark:text-slate-500 xl:text-left"},[f(" By using this service, you agree to our "),o("a",{class:"text-primary dark:text-slate-200",href:"/legal#terms",target:"_blank"}," Terms and Conditions "),f(" & "),o("a",{class:"text-primary dark:text-slate-200",href:"/legal#privacy"}," Privacy Policy ")],-1),Ne=T({__name:"Register",setup(Ve){const w=B(),C=F(),L=_(w.params.email),M=_(w.params.invite_token),S=_(navigator.userAgent),x=z(),E=D();var v=_();const $=_([]),V=G({email:L.value,invite_token:M.value,device_name:S,pronoun_id:0,password:"",password_confirm:"",is_agreed:0}),N={email:{required:p,email:W,minLength:b(5),maxLength:P(191)},invite_token:{required:p},device_name:{required:p},pronoun_id:{required:p,integer:Z,minValue:ee(1)},password:{required:p,minLength:b(6)},password_confirm:{required:p,minLength:b(6),maxLength:P(191)},is_agreed:{sameAs:te(!0)}},t=Q(N,I(V)),A=()=>{if(t.value.$touch(),t.value.$invalid)k(!1,"Please check the form.");else try{R.post("/api/register",V).then(s=>{x.storeState("success",s.data.message);const a=s.data.data.token,r=s.data.data;E.storeLoggedInUser(a,r),C.push("/")}).catch(s=>{x.storeState("error",s.response.data.message),console.log("Error sending registration:",s),k(!1,s.response.data.message)})}catch(s){x.storeState("error",s),console.log("Error sending registration:",s),k(!1,s)}};return K(async()=>{try{await R.get("/api/pronouns").then(s=>{$.value=s.data.data}).catch(s=>{x.$patch({status:"error"}),console.log("Error fetching pronouns:",s)})}catch(s){x.$patch({status:"error"}),console.error("Error fetching pronouns:",s)}}),(s,a)=>(l(),i("div",se,[n(e(O)),o("div",ae,[o("div",ie,[o("div",le,[de,o("div",ne,[o("img",{alt:"Amtgard Online Record Keeper v4",class:"w-1/2 -mt-16 -intro-x",src:e(H)},null,8,me),ue,ce])]),o("div",pe,[o("div",fe,[o("form",{class:"validate-form",onSubmit:j(A,["prevent"])},[xe,o("div",_e,[n(e(g),{id:"email",modelValue:e(t).email.$model,"onUpdate:modelValue":a[0]||(a[0]=r=>e(t).email.$model=r),modelModifiers:{trim:!0},type:"hidden",name:"email"},null,8,["modelValue"]),e(t).email.$error?(l(!0),i(m,{key:0},u(e(t).email.$errors,(r,d)=>(l(),i("div",{key:d,class:"mt-2 text-danger"}," No email detected "))),128)):c("",!0),n(e(g),{id:"invite_token",modelValue:e(t).invite_token.$model,"onUpdate:modelValue":a[1]||(a[1]=r=>e(t).invite_token.$model=r),modelModifiers:{trim:!0},type:"hidden",name:"invite_token"},null,8,["modelValue"]),e(t).invite_token.$error?(l(!0),i(m,{key:1},u(e(t).invite_token.$errors,(r,d)=>(l(),i("div",{key:d,class:"mt-2 text-danger"}," No invite token detected "))),128)):c("",!0),n(e(g),{id:"device_name",modelValue:e(t).device_name.$model,"onUpdate:modelValue":a[2]||(a[2]=r=>e(t).device_name.$model=r),modelModifiers:{trim:!0},type:"hidden",name:"device_name"},null,8,["modelValue"]),e(t).device_name.$error?(l(!0),i(m,{key:2},u(e(t).device_name.$errors,(r,d)=>(l(),i("div",{key:d,class:"mt-2 text-danger"}," Unable to determine device "))),128)):c("",!0),n(e(X),{id:"pronoun_id",modelValue:e(t).pronoun_id.$model,"onUpdate:modelValue":a[3]||(a[3]=r=>e(t).pronoun_id.$model=r),modelModifiers:{trim:!0},name:"pronoun_id",class:h(["mt-4",{"border-danger":e(t).pronoun_id.$error}]),placeholder:"Pronouns"},{default:U(()=>[ge,(l(!0),i(m,null,u($.value,(r,d)=>(l(),i("option",{key:d,value:r.id},y(r.subject+"/"+r.object),9,he))),128))]),_:1},8,["modelValue","class"]),e(t).pronoun_id.$error?(l(!0),i(m,{key:3},u(e(t).pronoun_id.$errors,(r,d)=>(l(),i("div",{key:d,class:"mt-2 text-danger"}," This field is required "))),128)):c("",!0),n(e(g),{id:"password",modelValue:e(t).password.$model,"onUpdate:modelValue":a[4]||(a[4]=r=>e(t).password.$model=r),modelModifiers:{trim:!0},type:"password",name:"password",class:h(["block px-4 py-3 mt-4 intro-x login__input min-w-full xl:min-w-[350px]",{"border-danger":e(t).password.$error}]),placeholder:"Password"},null,8,["modelValue","class"]),n(e(re),{password:e(t).password.$model},null,8,["password"]),e(t).password.$error?(l(!0),i(m,{key:4},u(e(t).password.$errors,(r,d)=>(l(),i("div",{key:d,class:"mt-2 text-danger"},y(r.$message),1))),128)):c("",!0),n(e(g),{id:"password_confirm",modelValue:e(t).password_confirm.$model,"onUpdate:modelValue":a[5]||(a[5]=r=>e(t).password_confirm.$model=r),modelModifiers:{trim:!0},type:"password",name:"password_confirm",class:h(["block px-4 py-3 mt-4 intro-x login__input min-w-full xl:min-w-[350px]",{"border-danger":e(t).password_confirm.$error}]),placeholder:"Confirm Password"},null,8,["modelValue","class"]),e(t).password_confirm.$error?(l(!0),i(m,{key:5},u(e(t).password_confirm.$errors,(r,d)=>(l(),i("div",{key:d,class:"mt-2 text-danger"},y(r.$message),1))),128)):c("",!0)]),o("div",ve,[n(e(J).Input,{id:"is_agreed",modelValue:e(t).is_agreed.$model,"onUpdate:modelValue":a[6]||(a[6]=r=>e(t).is_agreed.$model=r),modelModifiers:{trim:!0},type:"checkbox",name:"is_agreed",class:h(["mr-2 border",{"border-danger":e(t).is_agreed.$error}])},null,8,["modelValue","class"]),e(t).is_agreed.$error?(l(!0),i(m,{key:0},u(e(t).is_agreed.$errors,(r,d)=>(l(),i("div",{key:d,class:"mt-2 text-danger"}," You must agree to use the service "))),128)):c("",!0),ye,ke,f(" . ")]),o("div",be,[n(e(Y),{variant:"primary",type:"submit",class:"w-full px-4 py-3 align-top xl:w-32 xl:mr-3"},{default:U(()=>[f(" Register ")]),_:1}),o("div",we,[n(oe,{modelValue:e(v),"onUpdate:modelValue":a[7]||(a[7]=r=>q(v)?v.value=r:v=r),ref:"captcha",id:"register_id",inline:"",action:"register",style:{display:"inline"}},null,8,["modelValue"])])]),$e],32)])])])])]))}});export{Ne as default};
