import{d as A,r as b,m as E,q as N,x as B,y as F,s as T,v as V,c as l,b as i,u as e,a as s,H as z,F as m,f as c,A as u,n as _,e as p,w as D,a8 as I,z as K,b8 as q,o as d,b9 as G,ba as O,h as f,t as y,S as H,K as k}from"./main-DmBmZfxc.js";import{_ as Y}from"./Button.vue_vue_type_script_setup_true_lang-1zV1hq1_.js";import{u as j,r as g,e as J,m as v,a as U,s as Q}from"./index-Bz09TKPe.js";import{P as W}from"./vue-simple-password-meter.umd-Bs6RH9aC.js";import{G as X}from"./GoogleReCaptchaV3-DxzsoTt-.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const Z={class:_(["p-3 sm:px-8 relative h-screen lg:overflow-hidden bg-primary xl:bg-white dark:bg-darkmode-800 xl:dark:bg-darkmode-600","before:hidden before:xl:block before:content-[''] before:w-[57%] before:-mt-[28%] before:-mb-[16%] before:-ml-[13%] before:absolute before:inset-y-0 before:left-0 before:transform before:rotate-[-4.5deg] before:bg-primary/20 before:rounded-[100%] before:dark:bg-darkmode-400","after:hidden after:xl:block after:content-[''] after:w-[57%] after:-mt-[20%] after:-mb-[13%] after:-ml-[13%] after:absolute after:inset-y-0 after:left-0 after:transform after:rotate-[-4.5deg] after:bg-primary after:rounded-[100%] after:dark:bg-darkmode-700"])},ee={class:"container relative z-10 sm:px-10"},te={class:"block grid-cols-2 gap-4 xl:grid"},re={class:"flex-col hidden min-h-screen xl:flex"},se=s("a",{href:"",class:"flex items-center pt-5 -intro-x"},[s("span",{class:"ml-3 text-lg text-white"})],-1),ae={class:"my-auto"},oe=["src"],le=s("div",{class:"mt-10 text-4xl font-medium leading-tight text-white -intro-x"},[p(" Amtgard"),s("br"),p(" Online Record Keeper v4 ")],-1),de=s("div",{class:"mt-5 text-lg text-white -intro-x text-opacity-70 dark:text-slate-400"}," Live the Dream! ",-1),ne={class:"flex h-screen py-5 my-10 xl:h-auto xl:py-0 xl:my-0"},ie={class:"w-full px-5 py-8 mx-auto my-auto bg-white rounded-md shadow-md xl:ml-20 dark:bg-darkmode-600 xl:bg-transparent sm:px-8 xl:p-0 xl:shadow-none sm:w-3/4 lg:w-2/4 xl:w-auto"},me=s("h2",{class:"text-2xl font-bold text-center intro-x xl:text-3xl xl:text-left"}," Reset Password ",-1),ce={class:"mt-8 intro-x"},ue={class:"flex items-center mt-4 text-xs intro-x text-slate-600 dark:text-slate-500 sm:text-sm"},pe=s("label",{class:"cursor-pointer select-none",htmlFor:"remember-me"}," I agree to the ",-1),xe=s("a",{class:"ml-1 text-primary dark:text-slate-200",href:"/legal",target:"_blank"}," Privacy Policy & Terms of Use ",-1),fe={class:"flex items-center mt-4 text-xs intro-x text-slate-600 dark:text-slate-500 sm:text-sm"},ge={style:{display:"inline"}},_e=s("div",{class:"mt-10 text-center intro-x xl:mt-24 text-slate-600 dark:text-slate-500 xl:text-left"},[p(" By using this service, you agree to our "),s("a",{class:"text-primary dark:text-slate-200",href:"/legal#terms",target:"_blank"}," Terms and Conditions "),p(" & "),s("a",{class:"text-primary dark:text-slate-200",href:"/legal#privacy"}," Privacy Policy ")],-1),Ve=A({__name:"Reset",setup(he){const P=K(),R=q(),$=b(P.params.password_token),C=b(navigator.userAgent),x=E(),L=N();var h=b();const w=B({email:"",password_token:$.value,device_name:C,password:"",password_confirm:"",is_agreed:0}),S={email:{required:g,email:J,minLength:v(5),maxLength:U(191)},password_token:{required:g},device_name:{required:g},password:{required:g,minLength:v(6)},password_confirm:{required:g,minLength:v(6),maxLength:U(191)},is_agreed:{sameAs:Q(!0)}},t=j(S,F(w)),M=()=>{if(t.value.$touch(),t.value.$invalid)k(!1,"Please check the form.");else{console.log($),console.log(w);try{V.post("/api/reset",w).then(a=>{x.storeState("success",a.data.message);const o=a.data.data.token,r=a.data.data;L.storeLoggedInUser(o,r),R.push("/")}).catch(a=>{x.storeState("error",a.response.data.message),console.log("Error sending registration:",a),k(!1,a.response.data.message)})}catch(a){x.storeState("error",a),console.log("Error sending registration:",a),k(!1,a)}}};return T(async()=>{try{await V.get("/api/pronouns").then(a=>{pronouns.value=a.data.data}).catch(a=>{x.$patch({status:"error"}),console.log("Error fetching pronouns:",a)})}catch(a){x.$patch({status:"error"}),console.error("Error fetching pronouns:",a)}}),(a,o)=>(d(),l("div",Z,[i(e(G)),s("div",ee,[s("div",te,[s("div",re,[se,s("div",ae,[s("img",{alt:"Amtgard Online Record Keeper v4",class:"w-1/2 -mt-16 -intro-x",src:e(O)},null,8,oe),le,de])]),s("div",ne,[s("div",ie,[s("form",{class:"validate-form",onSubmit:z(M,["prevent"])},[me,s("div",ce,[i(e(f),{id:"password_token",modelValue:e(t).password_token.$model,"onUpdate:modelValue":o[0]||(o[0]=r=>e(t).password_token.$model=r),modelModifiers:{trim:!0},type:"hidden",name:"password_token"},null,8,["modelValue"]),e(t).password_token.$error?(d(!0),l(m,{key:0},c(e(t).password_token.$errors,(r,n)=>(d(),l("div",{key:n,class:"mt-2 text-danger"}," No reset token detected "))),128)):u("",!0),i(e(f),{id:"device_name",modelValue:e(t).device_name.$model,"onUpdate:modelValue":o[1]||(o[1]=r=>e(t).device_name.$model=r),modelModifiers:{trim:!0},type:"hidden",name:"device_name"},null,8,["modelValue"]),e(t).device_name.$error?(d(!0),l(m,{key:1},c(e(t).device_name.$errors,(r,n)=>(d(),l("div",{key:n,class:"mt-2 text-danger"}," Unable to determine device "))),128)):u("",!0),i(e(f),{id:"email",modelValue:e(t).email.$model,"onUpdate:modelValue":o[2]||(o[2]=r=>e(t).email.$model=r),modelModifiers:{trim:!0},type:"text",name:"email",class:_(["block px-4 py-3 intro-x login__input min-w-full xl:min-w-[350px]",{"border-danger":e(t).email.$error}]),placeholder:"Email"},null,8,["modelValue","class"]),e(t).email.$error?(d(!0),l(m,{key:2},c(e(t).email.$errors,(r,n)=>(d(),l("div",{key:n,class:"mt-2 text-danger"},y(r.$message),1))),128)):u("",!0),i(e(f),{id:"password",modelValue:e(t).password.$model,"onUpdate:modelValue":o[3]||(o[3]=r=>e(t).password.$model=r),modelModifiers:{trim:!0},type:"password",name:"password",class:_(["block px-4 py-3 mt-4 intro-x login__input min-w-full xl:min-w-[350px]",{"border-danger":e(t).password.$error}]),placeholder:"Password"},null,8,["modelValue","class"]),i(e(W),{password:e(t).password.$model},null,8,["password"]),e(t).password.$error?(d(!0),l(m,{key:3},c(e(t).password.$errors,(r,n)=>(d(),l("div",{key:n,class:"mt-2 text-danger"},y(r.$message),1))),128)):u("",!0),i(e(f),{id:"password_confirm",modelValue:e(t).password_confirm.$model,"onUpdate:modelValue":o[4]||(o[4]=r=>e(t).password_confirm.$model=r),modelModifiers:{trim:!0},type:"password",name:"password_confirm",class:_(["block px-4 py-3 mt-4 intro-x login__input min-w-full xl:min-w-[350px]",{"border-danger":e(t).password_confirm.$error}]),placeholder:"Confirm Password"},null,8,["modelValue","class"]),e(t).password_confirm.$error?(d(!0),l(m,{key:4},c(e(t).password_confirm.$errors,(r,n)=>(d(),l("div",{key:n,class:"mt-2 text-danger"},y(r.$message),1))),128)):u("",!0)]),s("div",ue,[i(e(H).Input,{id:"is_agreed",modelValue:e(t).is_agreed.$model,"onUpdate:modelValue":o[5]||(o[5]=r=>e(t).is_agreed.$model=r),modelModifiers:{trim:!0},type:"checkbox",name:"is_agreed",class:_(["mr-2 border",{"border-danger":e(t).is_agreed.$error}])},null,8,["modelValue","class"]),e(t).is_agreed.$error?(d(!0),l(m,{key:0},c(e(t).is_agreed.$errors,(r,n)=>(d(),l("div",{key:n,class:"mt-2 text-danger"}," You must agree to use the service "))),128)):u("",!0),pe,xe,p(" . ")]),s("div",fe,[i(e(Y),{variant:"primary",type:"submit",class:"w-full px-4 py-3 align-top xl:w-32 xl:mr-3"},{default:D(()=>[p(" Update Password ")]),_:1}),s("div",ge,[i(X,{modelValue:e(h),"onUpdate:modelValue":o[6]||(o[6]=r=>I(h)?h.value=r:h=r),ref:"captcha",id:"reset_id",inline:"",action:"reset",style:{display:"inline"}},null,8,["modelValue"])])]),_e],32)])])])])]))}});export{Ve as default};
